
## Reto
### substitution2
## Descripcion
It seems that another encrypted message has been intercepted. The encryptor seems to have learned their lesson though and now there isn't any punctuation! Can you still crack the cipher?Download the messageÂ [here](https://artifacts.picoctf.net/c/113/message.txt).
## Solucion
- nos dan este texto:
```
isnfnnpctitnznfmxhisnfwnxxntimjxctsnascdstushhxuhgqbinftnubfciruhgqnicichktckuxbackdurjnfqmifchimkabturjnfusmxxnkdnisntnuhgqnicichktehubtqfcgmfcxrhktrtingtmagckctifmichkebkamgnkimxtwscusmfnznfrbtnebxmkagmfonimjxntocxxtshwnznfwnjnxcnznisnqfhqnfqbfqhtnhemscdstushhxuhgqbinftnubfciruhgqnicichkctkhihkxrihinmuszmxbmjxntocxxtjbimxthihdnitibankitckinfntinackmkanpucinamjhbiuhgqbinftucnkunanenktcznuhgqnicichktmfnheinkxmjhfchbtmeemcftmkauhgnahwkihfbkkckdusnuoxctitmkanpnubickduhkecdtufcqitheenktnhkisnhisnfsmkactsnmzcxrehubtnahknpqxhfmichkmkacgqfhzctmichkmkaheinksmtnxngnkitheqxmrwnjnxcnznmuhgqnicichkihbusckdhkisnheenktcznnxngnkitheuhgqbinftnubfcirctisnfnehfnmjniinfznscuxnehfinusnzmkdnxctgihtibankitckmgnfcumkscdstushhxtebfisnfwnjnxcnznismimkbkanftimkackdheheenktczninuskcvbntctnttnkicmxehfghbkickdmkneenuicznanenktnmkaismiisnihhxtmkauhkecdbfmichkehubtnkuhbkinfnackanenktcznuhgqnicichktahntkhixnmatibankitihokhwisncfnkngrmtneenuicznxrmtinmusckdisngihmuicznxrisckoxconmkmiimuonfqcuhuiectmkheenktcznxrhfcnkinascdstushhxuhgqbinftnubfciruhgqnicichkismitnnotihdnknfminckinfntickuhgqbinftucnkunmghkdscdstushhxnftinmusckdisngnkhbdsmjhbiuhgqbinftnubfcirihqcvbnisncfubfchtcirghiczmickdisngihnpqxhfnhkisncfhwkmkankmjxckdisngihjniinfanenkaisncfgmusckntisnexmdctqcuhUIE{K6F4G_4K41R515_15_73A10B5_702E03EU}
```

- y ahora a diferencia de los otros 2 desafios el mensaje esta todo pegado, lo cual lo hara dificil de leer
- pero el proceso parece ser el mismo que en [substitution2](substitution2.md), vemos que al final estan las llaves "{}" y podemos sacar nuestra primera version de la llave con las palabras picoCTF: `v1. ??U??E??C?????HQ???I??????`
- de nuevo usaremos el mismo codigo que en  [substitution2](substitution2.md) y obtenemos el mensaje:
```
t??????i?t???????ot?????????t???i?????i???c?oo?co?p?t????c??it? co?p?titio? ?i?c???i??c????p?t?iot?????c????c????????t???? co?p?titio? ?foc??p?i???i??o????t??????i?i?t??tio?f???????t?????ic???????????f??????????t??????i????o??????????i???t??p?op??p??po??of??i???c?oo?co?p?t????c??it? co?p?titio? i??oto???tot??c???????????i?????t???oto??t?t????t?i?t????t??i??????cit????o?tco?p?t???ci??c???f???i?? co?p?titio? ????oft?????o?io???ff?i?????co???o??to????i??c??c??i?t???????c?ti??co?fi??c?ipt?off????o?t??ot???????i?????i??foc????o???p?o??tio????i?p?o?i??tio????oft???????????t?ofp????????i???? co?p?titio? to?c?i??o?t??off???i????????t?ofco?p?t????c??it?i?t????fo?????tt?????ic??fo?t?c????????i??to?t????t?i?????ic???i???c?oo??f??t????????i???t??t????????t???i??ofoff???i??t?c??i????i??????ti??fo??o??ti?????ff?cti????f???????t??tt??too?????co?fi????tio?foc????co??t????i???f???i?? co?p?titio? ??o???ot?????t????t?to??o?t??i?????????ff?cti??????t??c?i??t???to?cti????t?i???i?????tt?c???picoctfi???off???i????o?i??t???i???c?oo?co?p?t????c??it? co?p?titio? t??t?????to??????t?i?t????ti?co?p?t???ci??c???o???i???c?oo????t??c?i??t?????o?????o?tco?p?t????c??it?topi???t??i?c??io?it??oti??ti??t???to??p?o??o?t??i?o??????????i??t???to??tt????f???t??i???c?i???t??f???i?picoCTF{?6?4?_4?41?515_15_73?10?5_702F03FC}
```
- aun estando todo junto (los espacios los puse despues )puedo observar la palabra 
  "co?p?titio?", ahora como todo esta todo junto en el original, para buscar exactamente donde esta y que con que letra estan cambiadas, voy a usar expreciones regulares(regex)
- ahora transformo de letras originales a cifrado y donde no se que letra sea pongo ".", lo cual me deja con esto: `uh.q.icich.` y al buscarlo encuentro esto: 
![](../Imagenes/Pasted%20image%2020251103140312.png)

- esto me permite ver donde esta cada instancia de la palabra "competition" y tambien me da el sustituto de las letras m,e,n
- con esto puedo poner los espacios para esas palabras y hacer mi segunda vercion de la llave: `v2. ??U?NE??C???GKHQ???I??????`
- ahora el mesaje me queda asi:
```
t?e?ee?i?t?e?e???ot?e??e??e?t???i??e??i???c?oo?comp?te??ec??it? competition ?inc???in?c??e?p?t?iot?n???c??e?c????en?et?e?e competition ?foc??p?im??i??on???tem???mini?t??tionf?n??ment?????ic???e?e????ef???n?m???et???e??i????o?e?e??e?e?ie?et?ep?ope?p??po?eof??i???c?oo?comp?te??ec??it? competition i?noton??tote?c????????e??i?????t???oto?et?t??ent?inte?e?te?in?n?e?cite???o?tcomp?te??cience?efen?i?e competition ???eoften???o?io???ff?i???n?come?o?nto??nnin?c?ec??i?t??n?e?ec?tin?confi??c?ipt?offen?eont?eot?e???n?i??e??i??foc??e?one?p?o??tion?n?imp?o?i??tion?n?often???e?ement?ofp????e?e?ie?e? competition to?c?in?ont?eoffen?i?ee?ement?ofcomp?te??ec??it?i?t?e?efo?e??ette??e?ic?efo?tec?e??n?e?i?mto?t??ent?in?me?ic?n?i???c?oo??f??t?e??e?e?ie?et??t?n?n?e??t?n?in?ofoffen?i?etec?ni??e?i?e??enti??fo?mo?ntin??neffecti?e?efen?e?n?t??tt?etoo???n?confi????tionfoc??enco?nte?e?in?efen?i?e competition ??oe?not?e???t??ent?to?no?t?ei?enem???effecti?e????te?c?in?t?emto?cti?e??t?in??i?e?n?tt?c?e?picoctfi??noffen?i?e??o?iente??i???c?oo?comp?te??ec??it? competition t??t?ee??to?ene??teinte?e?tincomp?te??cience?mon??i???c?oo?e??te?c?in?t?emeno?????o?tcomp?te??ec??it?topi??et?ei?c??io?it?moti??tin?t?emtoe?p?o?eont?ei?o?n?n?en???in?t?emto?ette??efen?t?ei?m?c?ine?t?ef???i?picoCTF{N6?4M_4N41?515_15_73?10?5_702F03FC}
```
- y ahora repito el proceso, buscar alguna palabra, buscarla con regex y actualizar la llave
- lo siguiente que encuentro es "offen?i?e" y es lo que busco:
![](../Imagenes/Pasted%20image%2020251103144041.png)
- ...
- ...
- ...
- fue en este punto cuando recorde algo
![](../Imagenes/Pasted%20image%2020251103153436.png)

- recorde que esto ya lo habia echo mucho mas facil en alguna otra practica
- recorde que en una practica habia un cifrado donde cambiaban letras por la que sea sin ningun tipo de patron
- al buscar un poco en mis notas encontre la practica [waves over lambda](../Actividad_16/waves%20over%20lambda.md) , donde use [esta pagina](https://www.guballa.de/substitution-solver) para resolver un cifrado de substitucion  sin la llave
- al poner el texto original incluso sin espacios me regreso el texto resolvido donde se encontraba la bandera:**picoCTF{N6R4M_4N41Y515_15_73D10U5_702F03FC}**
```
thereexistseveralotherwellestablishedhighschoolcomputersecuritycompetitionsincludingcyberpatriotanduscyberchallengethesecompetitionsfocusprimarilyonsystemsadministrationfundamentalswhichareveryusefulandmarketableskillshoweverwebelievetheproperpurposeofahighschoolcomputersecuritycompetitionisnotonlytoteachvaluableskillsbutalsotogetstudentsinterestedinandexcitedaboutcomputersciencedefensivecompetitionsareoftenlaboriousaffairsandcomedowntorunningchecklistsandexecutingconfigscriptsoffenseontheotherhandisheavilyfocusedonexplorationandimprovisationandoftenhaselementsofplaywebelieveacompetitiontouchingontheoffensiveelementsofcomputersecurityisthereforeabettervehiclefortechevangelismtostudentsinamericanhighschoolsfurtherwebelievethatanunderstandingofoffensivetechniquesisessential formountingan effectivedefenseandthatthetoolsandconfigurationfocusencounteredindefensivecompetitionsdoesnotleadstudentstoknowtheirenemyaseffectivelyasteachingthemtoactivelythinklikeanattackerpicoctfisanoffensivelyorientedhighschoolcomputersecuritycompetitionthatseekstogenerateinterestincomputerscienceamonghighschoolersteachingthemenoughaboutcomputersecuritytopiquetheircuriositymotivatingthemtoexploreontheirownandenablingthemtobetterdefendtheirmachinestheflagispicoCTF{N6R4M_4N41Y515_15_73D10U5_702F03FC}

```
## Notas
- si no me hubiera acordado le hubiera seguido cifrando palabra por palabra y hubiera llegado a la bandera, pero me hubiera tardado bastante

## Referencias
[Substitution Solver | guballa.de](https://www.guballa.de/substitution-solver)